LAB PROGRAM 1
 
CREATE TABLE PUBLISHER(
NAME VARCHAR2 (20) PRIMARY KEY, 
PHONE INTEGER,
ADDRESS VARCHAR2 (20));
 
DESC PUBLISHER;
 
CREATE TABLE BOOK(
BOOK_ID INTEGER PRIMARY KEY, 
TITLE VARCHAR2 (20), 
PUB_YEAR VARCHAR2 (20),
PUBLISHER_NAME REFERENCES PUBLISHER (NAME) ON DELETE CASCADE);
 
DESC BOOK;
 
CREATE TABLE BOOK_AUTHORS 
(AUTHOR_NAME VARCHAR2 (20),
BOOK_ID REFERENCES BOOK (BOOK_ID) ON DELETE CASCADE, 
PRIMARY KEY (BOOK_ID, AUTHOR_NAME));
 
DESC BOOK_AUTHORS;
 
CREATE TABLE LIBRARY_PROGRAM(
PROG_ID INTEGER PRIMARY KEY, 
PROG_NAME VARCHAR2 (50), 
ADDRESS VARCHAR2 (50));
 
DESC LIBRARY_PROGRAM;
 
CREATE TABLE BOOK_COPIES 
(NO_OF_COPIES INTEGER,
BOOK_ID REFERENCES BOOK (BOOK_ID) ON DELETE CASCADE,
PROG_ID REFERENCES LIBRARY_PROGRAM (PROG_ID) ON DELETE CASCADE,
PRIMARY KEY (BOOK_ID, PROG_ID));
 
DESC BOOK_COPIES;
 
CREATE TABLE BOOK_LENDING 
(DATE_OUT DATE,
DUE_DATE DATE,
BOOK_ID REFERENCES BOOK (BOOK_ID) ON DELETE CASCADE,
PROG_ID REFERENCES LIBRARY_PROGRAM (PROG_ID) ON DELETE CASCADE,
CARD_NO NUMBER(4), 
PRIMARY KEY (BOOK_ID, PROG_ID));
 
DESC BOOK_LENDING;
 
CREATE TABLE CARD(
   CARD_NO NUMBER(3),
   PRIMARY KEY(CARD_NO)
);
 
DESC CARD;
 
INSERT INTO PUBLISHER VALUES ('MCGRAW-HILL', 9989076587, 'BANGALORE'); 
INSERT INTO PUBLISHER VALUES ('PEARSON', 9889076565, 'NEWDELHI');
INSERT INTO PUBLISHER VALUES ('RANDOM HOUSE', 7455679345, 'HYDRABAD');
INSERT INTO PUBLISHER VALUES ('HACHETTE LIVRE', 8970862340, 'CHENAI'); 
INSERT INTO PUBLISHER VALUES ('GRUPO PLANETA', 7756120238, 'BANGALORE');
 
SELECT *FROM PUBLISHER;
 
INSERT INTO BOOK VALUES (1,'DBMS','JAN-2017', 'MCGRAW-HILL'); 
INSERT INTO BOOK VALUES (2,'ADBMS','JUN-2016', 'MCGRAW-HILL'); 
INSERT INTO BOOK VALUES (3,'CN','SEP-2016', 'PEARSON');
INSERT INTO BOOK VALUES (4,'CG','SEP-2015', 'GRUPO PLANETA'); 
INSERT INTO BOOK VALUES (5,'OS','MAY-2016', 'PEARSON');
 
SELECT *FROM BOOK;
 
INSERT INTO BOOK_AUTHORS VALUES ('NAVATHE', 1); 
INSERT INTO BOOK_AUTHORS VALUES ('NAVATHE', 2); 
INSERT INTO BOOK_AUTHORS VALUES ('TANENBAUM', 3); 
INSERT INTO BOOK_AUTHORS VALUES ('EDWARD ANGEL', 4); 
INSERT INTO BOOK_AUTHORS VALUES ('GALVIN', 5);
 
SELECT *FROM BOOK_AUTHORS;
 
INSERT INTO LIBRARY_PROGRAM VALUES (10,'RR NAGAR','BANGALORE'); 
INSERT INTO LIBRARY_PROGRAM VALUES (11,'RNSIT','BANGALORE');
INSERT INTO LIBRARY_PROGRAM VALUES (12,'RAJAJI NAGAR', 'BANGALORE'); 
INSERT INTO LIBRARY_PROGRAM VALUES (13,'NITTE','MANGALORE');
INSERT INTO LIBRARY_PROGRAM VALUES (14,'MANIPAL','UDUPI');
 
SELECT *FROM LIBRARY_PROGRAM;
 
INSERT INTO BOOK_COPIES VALUES (10, 1, 10);
INSERT INTO BOOK_COPIES VALUES (5, 1, 11);
INSERT INTO BOOK_COPIES VALUES (2, 2, 12);
INSERT INTO BOOK_COPIES VALUES (5, 2, 13);
INSERT INTO BOOK_COPIES VALUES (7, 3, 14);
INSERT INTO BOOK_COPIES VALUES (1, 5, 10);
INSERT INTO BOOK_COPIES VALUES (3, 4, 11);
 
SELECT *FROM BOOK_COPIES;
 
INSERT INTO CARD VALUES (100); 
INSERT INTO CARD VALUES (101); 
INSERT INTO CARD VALUES (102); 
INSERT INTO CARD VALUES (103); 
INSERT INTO CARD VALUES (104);
 
SELECT *FROM CARD;
 
INSERT INTO BOOK_LENDING VALUES ('01-JAN-17','01-JUN-17', 1, 10, 101);
INSERT INTO BOOK_LENDING VALUES ('11-JAN-17','11-MAR-17', 3, 14, 101);
INSERT INTO BOOK_LENDING VALUES ('21-FEB-17','21-APR-17', 2, 13, 101);
INSERT INTO BOOK_LENDING VALUES ('15-MAR-17','15-JUL-17', 4, 11, 101);
INSERT INTO BOOK_LENDING VALUES ('12-APR-17','12-MAY-17', 1, 11, 104);
 
SELECT *FROM BOOK_LENDING;
 
SELECT B.BOOK_ID, B.TITLE, B.PUBLISHER_NAME, A.AUTHOR_NAME, 
C.NO_OF_COPIES, L.PROG_ID
FROM BOOK B, BOOK_AUTHORS A, BOOK_COPIES C, LIBRARY_PROGRAM L 
WHERE B.BOOK_ID=A.BOOK_ID
AND B.BOOK_ID=C.BOOK_ID
AND L.PROG_ID=C.PROG_ID;
 
SELECT CARD_NO 
FROM BOOK_LENDING
WHERE DATE_OUT BETWEEN '01-JAN-2017' AND '01-JUL-2017' 
GROUP BY CARD_NO
HAVING COUNT (*)>3;
 
DELETE FROM BOOK 
WHERE BOOK_ID=3;
 
SELECT *FROM BOOK;
 
CREATE VIEW V_PUBLICATION AS 
SELECT PUB_YEAR
FROM BOOK;
 
SELECT *FROM V_PUBLICATION;
 
CREATE VIEW V_BOOKS AS
SELECT B.BOOK_ID, B.TITLE, C.NO_OF_COPIES
FROM BOOK B, BOOK_COPIES C, LIBRARY_PROGRAM L
WHERE B.BOOK_ID=C.BOOK_ID 
AND C.PROG_ID=L.PROG_ID;
 
SELECT *FROM V_BOOKS;


LAB PROGRAM 2
 
CREATE TABLE SALESMAN (
SALESMAN_ID NUMBER (4), 
NAME VARCHAR2 (20),
CITY VARCHAR2 (20),
COMMISSION VARCHAR2 (20), 
PRIMARY KEY (SALESMAN_ID));
 
DESC SALESMAN;
 
CREATE TABLE CUSTOMER1 
(CUSTOMER_ID NUMBER (4),
CUST_NAME VARCHAR2 (20), 
CITY VARCHAR2 (20),
GRADE NUMBER (3),
PRIMARY KEY (CUSTOMER_ID),
SALESMAN_ID REFERENCES SALESMAN (SALESMAN_ID) ON DELETE SET NULL);
 
DESC CUSTOMER1;
 
CREATE TABLE ORDERS (
ORD_NO NUMBER (5),
PURCHASE_AMT NUMBER (10, 2), 
ORD_DATE DATE,
PRIMARY KEY (ORD_NO),
CUSTOMER_ID REFERENCES CUSTOMER1 (CUSTOMER_ID) ON DELETE CASCADE, 
SALESMAN_ID REFERENCES SALESMAN (SALESMAN_ID) ON DELETE CASCADE);
 
DESC ORDERS;
 
INSERT INTO SALESMAN VALUES (1000, 'JOHN','BANGALORE','25 %'); 
INSERT INTO SALESMAN VALUES (2000, 'RAVI','BANGALORE','20 %'); 
INSERT INTO SALESMAN VALUES (3000, 'KUMAR','MYSORE','15 %'); 
INSERT INTO SALESMAN VALUES (4000, 'SMITH','DELHI','30 %'); 
INSERT INTO SALESMAN VALUES (5000, 'HARSHA','HYDRABAD','15%');
 
SELECT *FROM SALESMAN;
 
INSERT INTO CUSTOMER1 VALUES (10, 'PREETHI','BANGALORE', 100, 1000);
INSERT INTO CUSTOMER1 VALUES (11, 'VIVEK','MANGALORE', 300, 1000);
INSERT INTO CUSTOMER1 VALUES (12, 'BHASKAR','CHENNAI', 400, 2000);
INSERT INTO CUSTOMER1 VALUES (13, 'CHETHAN','BANGALORE', 200, 2000);
INSERT INTO CUSTOMER1 VALUES (14, 'MAMATHA','BANGALORE', 400, 3000);
 
SELECT *FROM CUSTOMER1;
 
INSERT INTO ORDERS VALUES (50, 5000, '04-MAY-17', 10, 1000);
INSERT INTO ORDERS VALUES (51, 450, '20-JAN-17', 10, 2000);
INSERT INTO ORDERS VALUES (52, 1000, '24-FEB-17', 13, 2000);
INSERT INTO ORDERS VALUES (53, 3500, '13-APR-17', 14, 3000);
INSERT INTO ORDERS VALUES (54, 550, '09-MAR-17', 12, 2000); 
 
SELECT *FROM ORDERS;
 
SELECT GRADE, COUNT (DISTINCT CUSTOMER_ID) 
FROM CUSTOMER1
GROUP BY GRADE
HAVING GRADE > (SELECT AVG(GRADE) 
FROM CUSTOMER1
WHERE CITY='BANGALORE');
 
SELECT SALESMAN_ID, NAME 
FROM SALESMAN A
WHERE 1 < (SELECT COUNT (*)
FROM CUSTOMER1
WHERE SALESMAN_ID=A.SALESMAN_ID);
 
SELECT SALESMAN.SALESMAN_ID, NAME, CUST_NAME, COMMISSION 
FROM SALESMAN, CUSTOMER1
WHERE SALESMAN.CITY = CUSTOMER1.CITY 
UNION
SELECT SALESMAN_ID, NAME, 'NO MATCH', COMMISSION 
FROM SALESMAN
WHERE NOT CITY = ANY 
(SELECT CITY
FROM CUSTOMER1) 
ORDER BY 2 DESC;
 
CREATE VIEW ELITSALESMAN AS
SELECT B.ORD_DATE, A.SALESMAN_ID, A.NAME 
FROM SALESMAN A, ORDERS B
WHERE A.SALESMAN_ID = B.SALESMAN_ID
AND B.PURCHASE_AMT=(SELECT MAX (PURCHASE_AMT)
FROM ORDERS C
WHERE C.ORD_DATE = B.ORD_DATE);
 
SELECT *FROM ELITSALESMAN;
 
DELETE FROM SALESMAN 
WHERE SALESMAN_ID=1000;
 
SELECT *FROM SALESMAN;


LAB PROGRAM-3
CREATE TABLE ACTOR(
ACT_ID NUMBER(3),
ACT_NAME VARCHAR(20),
ACT_GENDER CHAR(1),
PRIMARY KEY (ACT_ID)
);
DESC ACTOR;
CREATE TABLE DIRECTOR(
DIR_ID NUMBER(3),
DIR_NAME VARCHAR(20),
DIR_PHONE NUMBER(10),
PRIMARY KEY (DIR_ID)
);
DESC DIRECTOR;
CREATE TABLE MOVIES(
MOV_ID NUMBER(4),
MOV_TITLE VARCHAR(15),
MOV_YEAR NUMBER(4),
MOV_LANG VARCHAR(15),
DIR_ID NUMBER(3),
PRIMARY KEY(MOV_ID),
FOREIGN KEY(DIR_ID) REFERENCES DIRECTOR(DIR_ID)
);
DESC MOVIES;
CREATE TABLE MOVIE_CAST(
ACT_ID NUMBER(3),
MOV_ID NUMBER(4),
ROLE VARCHAR(10),
PRIMARY KEY (ACT_ID, MOV_ID),
FOREIGN KEY (ACT_ID) REFERENCES ACTOR(ACT_ID),
FOREIGN KEY(MOV_ID) REFERENCES MOVIES(MOV_ID)
);
DESC MOVIE_CAST;
CREATE TABLE RATING(
MOV_ID NUMBER(4),
REV_STARS NUMBER(1),
PRIMARY KEY(MOV_ID),
FOREIGN KEY(MOV_ID) REFERENCES MOVIES(MOV_ID)
);
DESC RATING;
INSERT INTO ACTOR VALUES(1,'SUDEEP','M');
INSERT INTO ACTOR VALUES(2,'MEENA','F');
INSERT INTO ACTOR VALUES(3,'ANUSHKA','F');
INSERT INTO ACTOR VALUES(4,'JERMEY','M');
INSERT INTO ACTOR VALUES(5,'PRABAHS','M');
SELECT *FROM ACTOR;
INSERT INTO DIRECTOR VALUES(101,'JAGDEESH',9353842295);
INSERT INTO DIRECTOR VALUES(102,'HITCHCOCK',7385297350);
INSERT INTO DIRECTOR VALUES(103,'RAJAMOOULI',7694038291);
INSERT INTO DIRECTOR VALUES(104,'RAMESH',9563835747);
INSERT INTO DIRECTOR VALUES(105,'RAJKUMAR',8456372810);
SELECT *FROM DIRECTOR;
INSERT INTO MOVIES VALUES(1000,'MILANA',1994,'KANNADA',101);
INSERT INTO MOVIES VALUES(2000,'WARHOUSE',2000,'ENGLISH',102);
INSERT INTO MOVIES VALUES(3000, 'KHOOBSURAT',2017,'HINDI',104);
INSERT INTO MOVIES VALUES(4000,'KISMATH',2015,'KANNADA',105);
INSERT INTO MOVIES VALUES(5000,'KUSHI',2012,'HINDI',102);
SELECT *FROM MOVIES;
INSERT INTO MOVIE_CAST VALUES(1,1000,'HERO');
INSERT INTO MOVIE_CAST VALUES(1,5000,'HERO');
INSERT INTO MOVIE_CAST VALUES(3,2000,'HEROINE');
INSERT INTO MOVIE_CAST VALUES(5,4000,'HERO');
INSERT INTO MOVIE_CAST VALUES(4,2000,'HERO');
SELECT *FROM MOVIE_CAST;
INSERT INTO RATING VALUES(1000,3);
INSERT INTO RATING VALUES(3000,5);
INSERT INTO RATING VALUES(2000,4);
INSERT INTO RATING VALUES(4000,4);
INSERT INTO RATING VALUES(5000,2);
SELECT *FROM RATING;
SELECT MOV_TITLE
FROM MOVIES
WHERE DIR_ID IN(SELECT DIR_ID
FROM DIRECTOR
WHERE DIR_NAME ='HITCHCOCK');
SELECT MOV_TITLE
FROM MOVIES M, MOVIE_CAST MV
WHERE M.MOV_ID = MV.MOV_ID
AND ACT_ID IN(SELECT ACT_ID
FROM MOVIE_CAST
GROUP BY ACT_ID
HAVING COUNT(ACT_ID)>1)
GROUP BY MOV_TITLE
HAVING COUNT(*)>1;
SELECT ACT_NAME, MOV_TITLE, MOV_YEAR
FROM ACTOR A
JOIN MOVIE_CAST C
ON A.ACT_ID = C.ACT_ID
JOIN MOVIES M
ON C.MOV_ID= M.MOV_ID
WHERE M.MOV_YEAR NOT BETWEEN 2000 AND 2015;
SELECT MOV_TITLE, MAX (REV_STARS)
FROM MOVIES
INNER JOIN RATING USING (MOV_ID)
GROUP BY MOV_TITLE
HAVING MAX(REV_STARS)>0
ORDER BY MOV_TITLE;
UPDATE RATING
SET REV_STARS =5
WHERE MOV_ID IN(SELECT MOV_ID FROM MOVIES
WHERE DIR_ID IN
(SELECT DIR_ID
FROM DIRECTOR
WHERE DIR_NAME ='RAMESH'
));
SELECT *FROM RATING;
